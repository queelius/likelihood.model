<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CLAUDE.md • likelihood.model</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css"><script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet"><script src="pkgdown.js"></script><meta property="og:title" content="CLAUDE.md"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-title-body">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">likelihood.model</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="articles/exponential-lifetime.html">Exponential Lifetime Model</a>
    </li>
    <li>
      <a href="articles/getting-started.html">Getting Started with likelihood.model</a>
    </li>
    <li>
      <a href="articles/likelihood-contributions.html">Likelihood contributions model</a>
    </li>
    <li>
      <a href="articles/likelihood-name-model.html">Likelihood Named Distributions Model</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/queelius/likelihood.model/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
    <div class="page-header">
      <h1>CLAUDE.md</h1>
    </div>

<div id="claudemd" class="section level1">

<p>This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
<p><code>likelihood.model</code> is an R package for specifying and using likelihood models for statistical inference. It defines a generic framework where likelihood models implement key methods (<code>loglik</code>, <code>score</code>, <code>hess_loglik</code>) and provides two main implementations: <code>likelihood_contr_model</code> (for likelihood contributions with different observation types) and <code>likelihood_name_model</code> (for standard R distributions).</p>
<p>The package is designed to interoperate with the <code>algebraic.mle</code> package for maximum likelihood estimation and the <code>algebraic.dist</code> package for distributions.</p>
</div>
<div class="section level2">
<h2 id="development-commands">Development Commands<a class="anchor" aria-label="anchor" href="#development-commands"></a></h2>
<div class="section level3">
<h3 id="building-and-testing">Building and Testing<a class="anchor" aria-label="anchor" href="#building-and-testing"></a></h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install dependencies (core + suggested)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"devtools"</span>, <span class="st">"roxygen2"</span>, <span class="st">"testthat"</span>, <span class="st">"knitr"</span>, <span class="st">"rmarkdown"</span>, <span class="st">"dplyr"</span>, <span class="st">"tibble"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install companion packages (needed for full functionality)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"queelius/algebraic.mle"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"queelius/algebraic.dist"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load package during development (fastest workflow)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run tests</span></span>
<span><span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/test_file.html" class="external-link">test_file</a></span><span class="op">(</span><span class="st">"tests/test.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run test coverage analysis (important - tests are incomplete)</span></span>
<span><span class="fu">covr</span><span class="fu">::</span><span class="fu"><a href="http://covr.r-lib.org/reference/package_coverage.html" class="external-link">package_coverage</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build documentation from roxygen2 comments</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">document</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check package (CRAN standards)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/check.html" class="external-link">check</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build package tarball</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/build.html" class="external-link">build</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install from local source</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate documentation from roxygen2 comments</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/document.html" class="external-link">document</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build vignettes</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/build_vignettes.html" class="external-link">build_vignettes</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview pkgdown site</span></span>
<span><span class="fu">pkgdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgdown.r-lib.org/reference/build_site.html" class="external-link">build_site</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="architecture">Architecture<a class="anchor" aria-label="anchor" href="#architecture"></a></h2>
<p>The package is organized in layers, reflected in the file naming convention.</p>
<div class="section level3">
<h3 id="core-concept-likelihood-model">Core Concept: Likelihood Model<a class="anchor" aria-label="anchor" href="#core-concept-likelihood-model"></a></h3>
<p>The package defines <code>likelihood_model</code> as a <strong>concept</strong> (not a concrete class) that objects must satisfy. To be a likelihood model, an object must: - Have class <code>"likelihood_model"</code> in its inheritance chain - Implement <code>loglik(model, ...)</code> method that returns a log-likelihood function - Optionally implement <code>score(model, ...)</code> and <code>hess_loglik(model, ...)</code> (defaults use numerical differentiation via <code>numDeriv</code>)</p>
<p>Generic functions that operate on likelihood models: - <code><a href="reference/fit.likelihood_model.html">fit.likelihood_model()</a></code>: MLE solver using <code>optim</code>, returns <code>fisher_mle</code> objects - <code><a href="reference/sampler.likelihood_model.html">sampler.likelihood_model()</a></code>: Bootstrap sampling distribution via <code>boot</code> package - <code><a href="reference/lrt.html">lrt()</a></code>: Likelihood ratio test between nested models - <code><a href="reference/fim.html">fim()</a></code>: Fisher information matrix - <code><a href="reference/assumptions.html">assumptions()</a></code>: Retrieve model assumptions</p>
</div>
<div class="section level3">
<h3 id="main-implementations">Main Implementations<a class="anchor" aria-label="anchor" href="#main-implementations"></a></h3>
<p><strong><code>likelihood_contr_model</code></strong> (R6 class in <code>R/model-contr.R</code>): - <strong>Uses R6 classes</strong> (not S3) for object-oriented programming with mutable state - Handles heterogeneous observation types (exact, left-censored, right-censored, interval-censored) - Uses <code>obs_type</code> function to classify rows in data frame - Splits data by type and sums likelihood contributions (assumes i.i.d.) - Dynamically dispatches to type-specific functions: - Looks for <code>loglik.&lt;type&gt;</code>, <code>score.&lt;type&gt;</code>, <code>hess_loglik.&lt;type&gt;</code> functions - Falls back to numerical differentiation if analytical methods not found - Stores dispatchers in lists: <code>$logliks</code>, <code>$scores</code>, <code>$hess_logliks</code> - <strong>Important</strong>: R6 methods are called with <code>$</code> (e.g., <code>model$loglik(df, par)</code>) not S3 generics - S3 wrapper methods exist: <code><a href="reference/loglik.likelihood_contr_model.html">loglik.likelihood_contr_model()</a></code> wraps <code>model$loglik()</code></p>
<p><strong><code>likelihood_name_model</code></strong> (in <code>R/model-name.R</code>): - Wraps standard R distributions (e.g., “norm”, “weibull”, “exp”) - Uses R naming convention: <code>d&lt;name&gt;</code> (pdf), <code>p&lt;name&gt;</code> (cdf) - Handles censoring via <code>censor_col</code>: “left”, “right”, “interval”, or “exact”/NA - <code>prepare_args()</code> utility matches parameters to distribution function arguments</p>
</div>
<div class="section level3">
<h3 id="example-implementations">Example Implementations<a class="anchor" aria-label="anchor" href="#example-implementations"></a></h3>
<p><strong><code>weibull_uncensored</code></strong> (in <code>R/example-weibull.R</code>): - Specialized model for exact Weibull observations with analytical derivatives - Demonstrates providing explicit <code>loglik</code>, <code>score</code>, and <code>hess_loglik</code> methods - Analytical derivatives 10-100x faster than numerical differentiation - Can be used standalone or as a contribution in <code>likelihood_contr_model</code> - Backward-compatible alias: <code>likelihood_exact_weibull</code></p>
<p><strong><code>exponential_lifetime</code></strong> (in <code>R/example-exponential.R</code>): - Exponential distribution with optional right-censoring support - Demonstrates closed-form MLE (<code><a href="reference/fit.html">fit()</a></code> override bypasses <code>optim</code> entirely) - Provides analytical score, hessian, and FIM - Includes <code><a href="reference/rdata.html">rdata()</a></code> method for Monte Carlo validation - Sufficient statistics: d (exact count), T (total time), MLE: lambda_hat = d/T</p>
</div>
<div class="section level3">
<h3 id="key-implementation-details">Key Implementation Details<a class="anchor" aria-label="anchor" href="#key-implementation-details"></a></h3>
<ul><li>
<strong>Method dispatch</strong>: Uses S3 generics. Models add <code>"likelihood_model"</code> to class vector to inherit default methods</li>
<li>
<strong>Numerical defaults</strong>: <code><a href="reference/score.likelihood_model.html">score.likelihood_model()</a></code> and <code><a href="reference/hess_loglik.likelihood_model.html">hess_loglik.likelihood_model()</a></code> use Richardson extrapolation with <code>r=6</code> via <code>numDeriv</code>
</li>
<li>
<strong>Optimization</strong>: <code><a href="reference/fit.likelihood_model.html">fit.likelihood_model()</a></code> supports multiple <code>optim</code> methods (Nelder-Mead, BFGS, SANN, etc.). SANN useful for multimodal likelihoods but should be followed by local search</li>
<li>
<strong>Bootstrap</strong>: <code><a href="reference/sampler.likelihood_model.html">sampler.likelihood_model()</a></code> uses <code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code> with multicore parallelization support</li>
</ul></div>
<div class="section level3">
<h3 id="file-structure">File Structure<a class="anchor" aria-label="anchor" href="#file-structure"></a></h3>
<p><strong>Core layer</strong> (concept + infrastructure): - <code>R/core-generics.R</code>: Concept definition, generics (<code>loglik</code>, <code>score</code>, <code>hess_loglik</code>, <code>fim</code>, etc.), default methods, <code>print.likelihood_model</code> - <code>R/core-fit.R</code>: <code>fit</code> re-export, <code>fit.likelihood_model</code> (optim-based solver), <code>sampler.likelihood_model</code> (bootstrap) - <code>R/core-fisher_mle.R</code>: <code>fisher_mle</code> and <code>fisher_boot</code> result objects with S3 methods (<code>coef</code>, <code>vcov</code>, <code>confint</code>, <code>se</code>, <code>aic</code>, <code>bic</code>, <code>summary</code>) - <code>R/core-fisherian.R</code>: Fisherian inference (<code>support</code>, <code>relative_likelihood</code>, <code>likelihood_interval</code>, <code>profile_loglik</code>, <code>evidence</code>) - <code>R/core-lrt.R</code>: Likelihood ratio test (<code><a href="reference/lrt.html">lrt()</a></code>)</p>
<p><strong>Model builders</strong>: - <code>R/model-contr.R</code>: R6 class <code>likelihood_contr_model</code> for contribution-based models - <code>R/model-name.R</code>: <code><a href="reference/likelihood_name.html">likelihood_name()</a></code> wrapper for standard R distributions</p>
<p><strong>Example implementations</strong>: - <code>R/example-weibull.R</code>: <code>weibull_uncensored</code> with analytical derivatives - <code>R/example-exponential.R</code>: <code>exponential_lifetime</code> with closed-form MLE and right-censoring</p>
<p><strong>Tests and vignettes</strong>: - <code>tests/test.R</code>: 229 unit tests covering all model types and inference methods - <code>vignettes/getting-started.Rmd</code>: Quick introduction with examples - <code>vignettes/likelihood-contributions.Rmd</code>: Advanced examples with series systems - <code>vignettes/likelihood-name-model.Rmd</code>: Examples using named distributions</p>
</div>
</div>
<div class="section level2">
<h2 id="important-notes">Important Notes<a class="anchor" aria-label="anchor" href="#important-notes"></a></h2>
<div class="section level3">
<h3 id="testing-and-coverage">Testing and Coverage<a class="anchor" aria-label="anchor" href="#testing-and-coverage"></a></h3>
<ul><li>
<code>tests/test.R</code> contains 229 tests covering all model types and inference methods</li>
<li>When adding new features, write complete tests and run <code><a href="http://covr.r-lib.org/reference/package_coverage.html" class="external-link">covr::package_coverage()</a></code> to ensure coverage</li>
<li>Focus on testing edge cases: censored data, empty data frames, parameter validation</li>
<li>See vignettes for realistic examples to base tests on</li>
</ul></div>
<div class="section level3">
<h3 id="adding-new-distributions">Adding New Distributions<a class="anchor" aria-label="anchor" href="#adding-new-distributions"></a></h3>
<p>When adding new distribution support, choose one of these approaches: 1. <strong>For standard R distributions</strong>: Use <code>likelihood_name("dist_name", ob_col, censor_col)</code> - Works with any distribution that has <code>d&lt;name&gt;</code> and <code>p&lt;name&gt;</code> functions - Automatically handles censoring types 2. <strong>For custom likelihood contributions</strong>: Create <code>loglik.&lt;type&gt;</code>, <code>score.&lt;type&gt;</code>, <code>hess_loglik.&lt;type&gt;</code> functions - Used by <code>likelihood_contr_model</code> via dynamic dispatch - Provide analytical derivatives when possible (much faster than numerical) 3. <strong>For specialized models</strong>: Create a new class (like <code>weibull_uncensored</code> or <code>exponential_lifetime</code>) - Define S3 methods: <code>loglik.&lt;class&gt;</code>, <code>score.&lt;class&gt;</code>, <code>hess_loglik.&lt;class&gt;</code> - Add <code>"likelihood_model"</code> to class vector to inherit default behavior - Optionally override <code>fit.&lt;class&gt;</code> for closed-form MLEs (see <code>exponential_lifetime</code>)</p>
</div>
<div class="section level3">
<h3 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a></h3>
<ul><li>
<strong>Numerical differentiation is expensive</strong>: Default <code>score</code> and <code>hess_loglik</code> use <code>numDeriv</code> with Richardson extrapolation (<code>r=6</code>)</li>
<li>Provide analytical derivatives whenever possible (see <code>example-weibull.R</code> for example)</li>
<li>For Weibull: analytical derivatives ~10-100x faster than numerical</li>
<li>Parameters can be named or unnamed; <code>prepare_args()</code> handles both cases</li>
<li>Always validate inputs: check for NULL, positive values where required, sufficient sample size</li>
</ul></div>
<div class="section level3">
<h3 id="package-dependencies">Package Dependencies<a class="anchor" aria-label="anchor" href="#package-dependencies"></a></h3>
<ul><li>
<strong>Required</strong>: <code>mvtnorm</code>, <code>generics</code>, <code>MASS</code>, <code>stats</code>, <code>numDeriv</code>, <code>boot</code>, <code>dplyr</code>
</li>
<li>
<strong>Companion packages</strong>: <code>algebraic.mle</code> (MLE objects), <code>algebraic.dist</code> (distributions)</li>
<li>
<strong>Roxygen2</strong>: Version 7.3.1 for documentation generation</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="common-workflows">Common Workflows<a class="anchor" aria-label="anchor" href="#common-workflows"></a></h2>
<div class="section level3">
<h3 id="using-a-standard-distribution-simple-case">Using a Standard Distribution (Simple Case)<a class="anchor" aria-label="anchor" href="#using-a-standard-distribution-simple-case"></a></h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create model for normal distribution</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/likelihood_name.html">likelihood_name</a></span><span class="op">(</span><span class="st">"norm"</span>, ob_col <span class="op">=</span> <span class="st">"x"</span>, censor_col <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the model</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>  <span class="co"># initial guess: mean=0, sd=1</span></span>
<span></span>
<span><span class="co"># Get parameter estimates</span></span>
<span><span class="fu">params</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="handling-censored-data">Handling Censored Data<a class="anchor" aria-label="anchor" href="#handling-censored-data"></a></h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data with censoring column ("exact", "left", "right", "interval")</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">3.4</span>, <span class="fl">2.1</span><span class="op">)</span>,</span>
<span>  censor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"right"</span>, <span class="st">"left"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/likelihood_name.html">likelihood_name</a></span><span class="op">(</span><span class="st">"weibull"</span>, ob_col <span class="op">=</span> <span class="st">"x"</span>, censor_col <span class="op">=</span> <span class="st">"censor"</span><span class="op">)</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="using-likelihood-contributions-advanced-case">Using Likelihood Contributions (Advanced Case)<a class="anchor" aria-label="anchor" href="#using-likelihood-contributions-advanced-case"></a></h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define observation type function</span></span>
<span><span class="va">obs_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Returns "exact", "censored", etc. for each row</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">type</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Define type-specific log-likelihood functions</span></span>
<span><span class="va">loglik.exact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implementation for exact observations</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loglik.censored</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implementation for censored observations</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create contribution model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  obs_type <span class="op">=</span> <span class="va">obs_type</span>,</span>
<span>  assumptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"iid"</span>, <span class="st">"exponential components"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit as usual</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="va">initial_params</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="likelihood-ratio-test">Likelihood Ratio Test<a class="anchor" aria-label="anchor" href="#likelihood-ratio-test"></a></h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nested models (null is subset of alternative)</span></span>
<span><span class="va">null_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit.html">fit</a></span><span class="op">(</span><span class="va">null_model</span><span class="op">)</span><span class="op">(</span><span class="va">df</span>, <span class="va">par_null</span><span class="op">)</span></span>
<span><span class="va">alt_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit.html">fit</a></span><span class="op">(</span><span class="va">alt_model</span><span class="op">)</span><span class="op">(</span><span class="va">df</span>, <span class="va">par_alt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform LRT</span></span>
<span><span class="va">lrt_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/lrt.html">lrt</a></span><span class="op">(</span></span>
<span>  null <span class="op">=</span> <span class="va">null_model</span>,</span>
<span>  alt <span class="op">=</span> <span class="va">alt_model</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  null_par <span class="op">=</span> <span class="fu">params</span><span class="op">(</span><span class="va">null_result</span><span class="op">)</span>,</span>
<span>  alt_par <span class="op">=</span> <span class="fu">params</span><span class="op">(</span><span class="va">alt_result</span><span class="op">)</span>,</span>
<span>  dof <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">params</span><span class="op">(</span><span class="va">alt_result</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">params</span><span class="op">(</span><span class="va">null_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check p-value</span></span>
<span><span class="va">lrt_result</span><span class="op">$</span><span class="va">p.value</span></span></code></pre></div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>

</div>



      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

