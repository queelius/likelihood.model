<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Likelihood contributions model • likelihood.model</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood contributions model">
<meta property="og:description" content="likelihood.model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">likelihood.model</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/likelihood-contributions.html">Likelihood contributions model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/likelihood.model/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="likelihood-contributions_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Likelihood contributions model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/likelihood.model/blob/HEAD/vignettes/likelihood-contributions.Rmd" class="external-link"><code>vignettes/likelihood-contributions.Rmd</code></a></small>
      <div class="hidden name"><code>likelihood-contributions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>likelihood.model</code> from <a href="https://github.com/queelius/likelihood.model" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"queelius/likelihood.model"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/queelius/likelihood.model" class="external-link">likelihood.model</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'likelihood.model'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:algebraic.mle':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     fim, score</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="exponential-series-system">Exponential series system<a class="anchor" aria-label="anchor" href="#exponential-series-system"></a>
</h2>
<p>Consider a series system with <span class="math inline">\(m\)</span> components, where the <span class="math inline">\(p\)</span>th component in the <span class="math inline">\(i\)</span>-th system has lifetime <span class="math inline">\(T_{i p}\)</span> with rate <span class="math inline">\(\lambda_p\)</span>, and <span class="math inline">\(T_{i j}\)</span> for all <span class="math inline">\(i,j\)</span> are independent. The system lifetime is the minimum of the component lifetimes, i.e., <span class="math inline">\(T_i = \min\{T_{i 1}, \ldots, T_{i m}\}\)</span>.</p>
<p>Let’s draw a sample for this model for <span class="math inline">\(m=3\)</span> and <span class="math inline">\(\lambda = (1, 1.25, 1.5)\)</span> for a sample size of <span class="math inline">\(n=75\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">70</span></span>
<span><span class="va">rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.25</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                 t2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                 t3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># map each observation to the corresponding index (component) that was minimum</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">1</span>, <span class="va">which.min</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           t1        t2         t3          t k</span></span>
<span><span class="co">## 1 0.76677933 1.3139236 0.44257008 0.44257008 3</span></span>
<span><span class="co">## 2 0.52419116 1.2959302 1.07292810 0.52419116 1</span></span>
<span><span class="co">## 3 1.20823170 2.0289164 0.40455806 0.40455806 3</span></span>
<span><span class="co">## 4 0.02870669 1.2172397 0.06243488 0.02870669 1</span></span>
<span><span class="co">## 5 0.05110089 0.3040114 0.21642352 0.05110089 1</span></span>
<span><span class="co">## 6 0.28772838 0.1908104 1.17325487 0.19081037 2</span></span></code></pre>
<p>Column <span class="math inline">\(t_p\)</span> is the failure time of the <span class="math inline">\(p\)</span>-th component, column <span class="math inline">\(t\)</span> is the column for the series system lifetime, and column <span class="math inline">\(k\)</span> is the component that causes the system failure.</p>
<p>Of course, normally we don’t know the component lifetimes, but only the series system lifetime (or a censored version of it). However, sometimes, we may know more or less. We will consider three cases:</p>
<ol style="list-style-type: decimal">
<li>We know the component lifetimes exactly. (Columns <span class="math inline">\(t_1, \ldots, t_m\)</span> are observed.)</li>
<li>We know the system lifetime and the component cause of failure. (Columns <span class="math inline">\(t\)</span> and <span class="math inline">\(k\)</span> are observed.)</li>
<li>We know the system lifetime, and some subset of the components that contains the component that caused the system failure. (New columns will be introduced to indicate which components are observed.)</li>
</ol>
<div class="section level3">
<h3 id="case-1-complete-knowledge-of-component-lifetimes">Case 1: Complete knowledge of component lifetimes<a class="anchor" aria-label="anchor" href="#case-1-complete-knowledge-of-component-lifetimes"></a>
</h3>
<p>Suppose we have a series system, but we have complete knowledge of the component lifetimes. The component lifetimes are exponentially distributed with rate <span class="math inline">\(\lambda_k\)</span> for component <span class="math inline">\(k\)</span>.</p>
<p>The system lifetime is the minimum of the component lifetimes, but we actually know the component lifetimes somehow, so we just estimate each <span class="math inline">\(\lambda_k\)</span> separately (<span class="math inline">\(m\)</span> independent MLE problems), which we know to have the MLE <span class="math inline">\(\hat{\lambda}_p = 1/{\bar{t}_p}\)</span> where <span class="math inline">\(\bar{t}_p\)</span> is the sample mean of the component lifetimes for component <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">lambda.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.070043 1.250383 1.533236</span></span></code></pre>
<div class="section level4">
<h4 id="likelihood-model">Likelihood model<a class="anchor" aria-label="anchor" href="#likelihood-model"></a>
</h4>
<p>Let’s derive the full likelihood model for this problem anyway. The likelihood function is given by so we use those instead. The likelihood function is given by <span class="math inline">\(L(\lambda_1, \dots, \lambda_p) = \prod_{i=1}^n \prod_{j=1}^m \lambda_j \exp(-\lambda_j t_{i j})\)</span>, whose log-likelihood function is given by <span class="math inline">\(\ell (\lambda_1, \dots, \lambda_p) = \sum_{i=1}^n \sum_{j=1}^m \log \lambda_p - \lambda_p t_{i j}\)</span>, whose score function is given by <span class="math inline">\(s(\lambda_1, \dots, \lambda_p) = (\partial \ell / \partial \lambda_1 \cdots  \partial \ell / \partial \lambda_m)^T\)</span> where <span class="math inline">\(\partial \ell / \partial  \lambda_p = n/\lambda_p - \sum_{i=1}^n t_{i p}\)</span>, and whose Hessian matrix is a diagonal matrix whose <span class="math inline">\((p,p)\)</span>-th element is given by <span class="math inline">\(\partial^2 \ell / \partial \lambda_p^2 = -\frac{n}{\lambda_p^2}\)</span>.</p>
<p>To solve the MLE, we just solve the score equations <span class="math inline">\(s(\lambda_1, \dots, \lambda_p) = 0\)</span>, which has the unique solution <span class="math inline">\(\hat{\lambda}_p = 1/{\bar{t}_p}\)</span>.</p>
<p>So, the sampling distribution of <span class="math inline">\(\hat\lambda_p\)</span> is given by <span class="math display">\[
\hat\lambda_p \sim \text{Gamma}(n, 1  / \lambda_p),
\]</span> and asymptotically, by the CLT, it is given by <span class="math display">\[
\hat\lambda_p \sim \text{Normal}(\lambda_p, \lambda_p^2 / n),
\]</span> which we may in either case replace <span class="math inline">\(\lambda_p\)</span> with <span class="math inline">\(\hat\lambda_p\)</span> to get respectively the approximate sampling and approximate asymptotic sampling distribution of <span class="math inline">\(\hat\lambda_p\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.exp.complete</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="st">"observed"</span></span>
<span>    <span class="op">}</span>,</span>
<span>    logliks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">t1</span>, <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">t2</span>, <span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">t3</span>, <span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span>,</span>
<span>    scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">row</span><span class="op">$</span><span class="va">t1</span>,</span>
<span>              <span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">row</span><span class="op">$</span><span class="va">t2</span>,</span>
<span>              <span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">row</span><span class="op">$</span><span class="va">t3</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hess_logliks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">par</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>         , <span class="fl">0</span>,</span>
<span>                      <span class="fl">0</span>         , <span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>,</span>
<span>                      <span class="fl">0</span>         , <span class="fl">0</span>         , <span class="fl">1</span><span class="op">/</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>                nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ll.exp.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model.exp.complete</span><span class="op">)</span></span>
<span><span class="va">s.exp.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">model.exp.complete</span><span class="op">)</span></span>
<span><span class="va">H.exp.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hess_loglik.html">hess_loglik</a></span><span class="op">(</span><span class="va">model.exp.complete</span><span class="op">)</span></span></code></pre></div>
<p>The MLE is just:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.exp.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">rates</span>, fn <span class="op">=</span> <span class="va">ll.exp.complete</span>, gr <span class="op">=</span> <span class="va">s.exp.complete</span>,</span>
<span>    df <span class="op">=</span> <span class="va">df</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res.exp.complete</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.070296 1.250357 1.533323</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lambda.hat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1.070043 1.250383 1.533236</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ll.exp.complete</span><span class="op">(</span><span class="va">df</span>, <span class="va">res.exp.complete</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -159.703</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res.exp.complete</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] -159.703</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res.exp.complete</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] -61.10696   0.00000   0.00000</span></span>
<span><span class="co">## [2,]   0.00000 -44.77448   0.00000</span></span>
<span><span class="co">## [3,]   0.00000   0.00000 -29.77357</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">H.exp.complete</span><span class="op">(</span><span class="va">df</span>, <span class="va">res.exp.complete</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] -61.1069   0.00000   0.00000</span></span>
<span><span class="co">## [2,]   0.0000 -44.77445   0.00000</span></span>
<span><span class="co">## [3,]   0.0000   0.00000 -29.77356</span></span></code></pre>
<p>We see that the two MLEs, the analytical one and the numerical one, are the same.</p>
<p>The sampling distribution of the MLE is given by:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mle.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/mle_numerical.html" class="external-link">mle_numerical</a></span><span class="op">(</span><span class="va">res.exp.complete</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mle.samp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Maximum likelihood estimator of type mle_numerical is normally distributed.</span></span>
<span><span class="co">## The estimates of the parameters are given by:</span></span>
<span><span class="co">## [1] 1.070296 1.250357 1.533323</span></span>
<span><span class="co">## The standard error is  0.1279248 0.1494461 0.1832671 .</span></span>
<span><span class="co">## The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">##             2.5%    97.5%</span></span>
<span><span class="co">## param1 0.8598784 1.280713</span></span>
<span><span class="co">## param2 1.0045396 1.496174</span></span>
<span><span class="co">## param3 1.2318754 1.834771</span></span>
<span><span class="co">## The MSE of the estimator is  0.07228573 .</span></span>
<span><span class="co">## The log-likelihood is  -159.703 .</span></span>
<span><span class="co">## The AIC is  325.406 .</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="case-2-known-component-cause-but-masked-component-lifetimes">Case 2: Known component cause, but masked component lifetimes<a class="anchor" aria-label="anchor" href="#case-2-known-component-cause-but-masked-component-lifetimes"></a>
</h3>
<p>In this case, we assume we can only observe the system lifetime and the component that caused the system failure.</p>
<p>We might be tempted to think that we can just consider each observation, where we know the system lifetime and the componente cause, and then just estimate the component lifetime for that component based on its failure time. We have less information about the parameters, because each observation only gives us information about one component, but that’s okay.</p>
<p>However, this is incorrect, because when we condition on the component that caused the system failure, we are not observing a random sample of that component’s lifetime, but a conditional sample. For instance, if <span class="math inline">\(k = 1\)</span>, then we are observing <span class="math inline">\(T_{i 1} | T_{i 1} &lt; T_{i 2} \text{ and } T_{i 1} &lt; T_{i 3}\)</span>.</p>
<p>What is this distribution? We can derive it as:</p>
<p><span class="math display">\[
    f_{T_i|K_i}(t_i | k_i) = f_{T_i,K_i}(t_i,k_i) / f_{K_i}(k_i) =
        f_{K_i|T_i}(k_i|t_i) f_{T_i}(t_i) / f_{K_i}(k_i).
\]</span> By the memoryless property of the exponential distribution, we have <span class="math display">\[
    f_{K_i|T_i}(k_i|t_i) = f_{K_i}(k_i),
\]</span> since the failure rates are constant (and thus independent of the time), and thus the probability that a componet is the cause of a system failure is independent of the time of the system failure.</p>
<p>That means that <span class="math display">\[
    f_{T_i|K_i}(t_i | k_i) = f_{T_i}(t_i),
\]</span> which is the density of the series system. Since the minimum of exponentially distributed random variables is exponentially distributed with a falure rate equal to the sum of the failure rates of the components, this estimator is an estimator of the sum of the failure rates (or the failure rate of the series system). Let’s do this computation:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.exp.series</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="st">"observed"</span></span>
<span>    <span class="op">}</span>,</span>
<span>    logliks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">row</span><span class="op">$</span><span class="va">t</span>, <span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ll.exp.series</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model.exp.series</span><span class="op">)</span></span>
<span><span class="va">res.exp.series</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">rates</span>, fn <span class="op">=</span> <span class="va">ll.exp.series</span>, df <span class="op">=</span> <span class="va">df</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res.exp.series</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.691628 4.273178 3.720431</span></span></code></pre>
<p>Each of these are more or less reasonable estimates of the true failure rate of the system, which is <span class="math inline">\((1.1 + 1.25 + 1.5) = 3.85\)</span>.</p>
<p>However, we can combine each of these estimates into a weighted mean to get a better estimate. The weights are the number of observations for each component. We actually went ahead and analytically computed the MLE for this, also:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># print some summary statistics</span></span>
<span><span class="co"># first, show how many rows have k = j</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">N</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">k</span> <span class="op">==</span> <span class="va">j</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"counts("</span>, <span class="va">j</span>, <span class="st">") = "</span>, <span class="va">N</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## counts( 1 ) =  17 </span></span>
<span><span class="co">## counts( 2 ) =  24 </span></span>
<span><span class="co">## counts( 3 ) =  29</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t.sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"total system lifetimes = "</span>, <span class="va">t.sum</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## total system lifetimes =  19.72759</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sum of system lifetimes for k = j </span></span>
<span><span class="va">t.sum.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">t.sum.k</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">k</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum of system lifetimes for k = "</span>, <span class="va">j</span>, <span class="st">" = "</span>, <span class="va">t.sum.k</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## sum of system lifetimes for k =  1  =  6.31582 </span></span>
<span><span class="co">## sum of system lifetimes for k =  2  =  5.616639 </span></span>
<span><span class="co">## sum of system lifetimes for k =  3  =  7.795127</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MLE (analytical solution)</span></span>
<span><span class="co"># lambda_j = N_j / t_j</span></span>
<span><span class="op">(</span><span class="va">lambda.hat2</span> <span class="op">&lt;-</span> <span class="va">N</span> <span class="op">/</span> <span class="va">t.sum.k</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.691654 4.273018 3.720273</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.exp.series</span><span class="op">$</span><span class="va">par</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.691628 4.273178 3.720431</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res.exp.series</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">N</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">res.exp.series</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">N</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">res.exp.series</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">N</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.660092</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.85</span></span></code></pre>
<p>We see that this is a pretty good estimator of the true failure rate of the system, but it tells us nothing about the failure rate of the components.</p>
<div class="section level4">
<h4 id="joint-distribution-of-t_i-and-k_i">Joint distribution of <span class="math inline">\(T_i\)</span> and <span class="math inline">\(K_i\)</span><a class="anchor" aria-label="anchor" href="#joint-distribution-of-t_i-and-k_i"></a>
</h4>
<p>Instead of maximizing the conditional likelihood based on <span class="math inline">\(T_i | K_i\)</span>, we should be maximizing the joint likelihood of <span class="math inline">\(T_i\)</span> and <span class="math inline">\(K_i\)</span>:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.exp.known</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="st">"observed"</span></span>
<span>    <span class="op">}</span>,</span>
<span>    logliks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="va">row</span><span class="op">$</span><span class="va">t</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span>,</span>
<span>    scores <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="va">row</span><span class="op">$</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="va">v</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span></span>
<span>            <span class="va">v</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span>,</span>
<span>    hess_logliks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        observed <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span>
<span>            <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span>            <span class="va">H</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span>, <span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span>
<span>            <span class="va">H</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ll.exp.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model.exp.known</span><span class="op">)</span></span>
<span><span class="va">s.exp.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">model.exp.known</span><span class="op">)</span></span>
<span><span class="va">H.exp.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hess_loglik.html">hess_loglik</a></span><span class="op">(</span><span class="va">model.exp.known</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate.known</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">rates</span>, fn <span class="op">=</span> <span class="va">ll.exp.known</span>, gr <span class="op">=</span> <span class="va">s.exp.known</span>, df <span class="op">=</span> <span class="va">df</span>,</span>
<span>    hessian <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/mle_numerical.html" class="external-link">mle_numerical</a></span><span class="op">(</span><span class="va">rate.known</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Maximum likelihood estimator of type mle_numerical is normally distributed.</span></span>
<span><span class="co">## The estimates of the parameters are given by:</span></span>
<span><span class="co">## [1] 0.8619292 1.2164711 1.4701796</span></span>
<span><span class="co">## The standard error is  0.2090484 0.248311 0.2730054 .</span></span>
<span><span class="co">## The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">##             2.5%    97.5%</span></span>
<span><span class="co">## param1 0.5180752 1.205783</span></span>
<span><span class="co">## param2 0.8080358 1.624906</span></span>
<span><span class="co">## param3 1.0211256 1.919234</span></span>
<span><span class="co">## The MSE of the estimator is  0.1798916 .</span></span>
<span><span class="co">## The log-likelihood is  -56.65176 .</span></span>
<span><span class="co">## The AIC is  119.3035 .</span></span></code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"score.observed"</span><span class="op">)</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="va">row</span><span class="op">$</span><span class="va">t</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">v</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span></span>
<span>    <span class="va">v</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">hess_loglik.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"hess_loglik.observed"</span><span class="op">)</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span></span>
<span>    <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span>    <span class="va">H</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span>, <span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span>
<span>    <span class="va">H</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loglik.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span>, <span class="va">rate</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rate</span><span class="op">[</span><span class="va">row</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rate</span><span class="op">)</span> <span class="op">*</span> <span class="va">row</span><span class="op">$</span><span class="va">t</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.exp.known2</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">row</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="st">"observed"</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ll.exp.known2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model.exp.known2</span><span class="op">)</span></span>
<span><span class="va">s.exp.known2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/score.html">score</a></span><span class="op">(</span><span class="va">model.exp.known2</span><span class="op">)</span></span>
<span><span class="va">H.exp.known2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hess_loglik.html">hess_loglik</a></span><span class="op">(</span><span class="va">model.exp.known2</span><span class="op">)</span></span>
<span><span class="va">rate.known2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">rates</span>, fn <span class="op">=</span> <span class="va">ll.exp.known2</span>, gr <span class="op">=</span> <span class="va">s.exp.known2</span>,</span>
<span>    df <span class="op">=</span> <span class="va">df</span>, hessian <span class="op">=</span> <span class="cn">TRUE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span>
<span><span class="co">## [1] "score.observed"</span></span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">rate.known2</span><span class="op">$</span><span class="va">hessian</span><span class="op">-</span><span class="fu">H.exp.known2</span><span class="op">(</span><span class="va">df</span>, <span class="va">rate.known2</span><span class="op">$</span><span class="va">par</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span></code></pre>
<pre><code><span><span class="co">## [1] 1.107345e-09</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">H.exp.known2</span><span class="op">(</span><span class="va">df</span>, <span class="va">rate.known2</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span>
<span><span class="co">## [1] "hess_loglik.observed"</span></span></code></pre>
<pre><code><span><span class="co">##           [,1]      [,2]      [,3]</span></span>
<span><span class="co">## [1,] -22.88262   0.00000   0.00000</span></span>
<span><span class="co">## [2,]   0.00000 -16.21839   0.00000</span></span>
<span><span class="co">## [3,]   0.00000   0.00000 -13.41706</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://queelius.github.io/algebraic.mle/reference/mle_numerical.html" class="external-link">mle_numerical</a></span><span class="op">(</span><span class="va">rate.known2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Maximum likelihood estimator of type mle_numerical is normally distributed.</span></span>
<span><span class="co">## The estimates of the parameters are given by:</span></span>
<span><span class="co">## [1] 0.8619292 1.2164711 1.4701796</span></span>
<span><span class="co">## The standard error is  0.2090484 0.248311 0.2730054 .</span></span>
<span><span class="co">## The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">##             2.5%    97.5%</span></span>
<span><span class="co">## param1 0.5180752 1.205783</span></span>
<span><span class="co">## param2 0.8080358 1.624906</span></span>
<span><span class="co">## param3 1.0211256 1.919234</span></span>
<span><span class="co">## The MSE of the estimator is  0.1798916 .</span></span>
<span><span class="co">## The log-likelihood is  -56.65176 .</span></span>
<span><span class="co">## The AIC is  119.3035 .</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate.known2</span><span class="op">$</span><span class="va">hessian</span></span></code></pre></div>
<pre><code><span><span class="co">##           [,1]     [,2]      [,3]</span></span>
<span><span class="co">## [1,] -22.88265   0.0000   0.00000</span></span>
<span><span class="co">## [2,]   0.00000 -16.2184   0.00000</span></span>
<span><span class="co">## [3,]   0.00000   0.0000 -13.41706</span></span></code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
