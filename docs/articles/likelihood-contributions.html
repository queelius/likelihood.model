<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Likelihood contributions model • likelihood.model</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood contributions model">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">likelihood.model</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/algebraic-mle-integration.html">Integration with algebraic.mle and algebraic.dist</a>
    </li>
    <li>
      <a href="../articles/exponential-lifetime.html">Exponential Lifetime Model</a>
    </li>
    <li>
      <a href="../articles/getting-started.html">Getting Started with likelihood.model</a>
    </li>
    <li>
      <a href="../articles/likelihood-contributions.html">Likelihood contributions model</a>
    </li>
    <li>
      <a href="../articles/likelihood-name-model.html">Likelihood Named Distributions Model</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/queelius/likelihood.model/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Likelihood contributions model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/likelihood.model/blob/HEAD/vignettes/likelihood-contributions.Rmd" class="external-link"><code>vignettes/likelihood-contributions.Rmd</code></a></small>
      <div class="hidden name"><code>likelihood-contributions.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of
<code>likelihood.model</code> from <a href="https://github.com/queelius/likelihood.model" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"queelius/likelihood.model"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exponential-series-system">Exponential series system<a class="anchor" aria-label="anchor" href="#exponential-series-system"></a>
</h2>
<p>Consider a series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components, where the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>th
component in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
system has lifetime
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><annotation encoding="application/x-tex">T_{i p}</annotation></semantics></math>
with rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\lambda_p</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">T_{i j}</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math>
are independent. The system lifetime is the minimum of the component
lifetimes, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">T_i = \min\{T_{i 1}, \ldots, T_{i m}\}</annotation></semantics></math>.</p>
<p>Let’s draw a sample for this model for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m=3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.1</mn><mo>,</mo><mn>1.2</mn><mo>,</mo><mn>1.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda = (1.1, 1.2, 1.3)</annotation></semantics></math>
for a sample size of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">n=150</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">150</span></span>
<span><span class="va">rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1235</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    t1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    t2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    t3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">rates</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">1</span>, <span class="va">min</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># map each observation to the corresponding index (component) that was minimum</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">1</span>, <span class="va">which.min</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">p</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">p</span> <span class="op">==</span> <span class="va">df</span><span class="op">$</span><span class="va">k</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="kw">next</span></span>
<span>        <span class="va">df</span><span class="op">[</span><span class="va">i</span>, <span class="va">p</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;      t1    t2   t3     t k</span></span>
<span><span class="co">#&gt; 1    NA 0.320   NA 0.320 2</span></span>
<span><span class="co">#&gt; 2    NA 0.045   NA 0.045 2</span></span>
<span><span class="co">#&gt; 3    NA 0.049   NA 0.049 2</span></span>
<span><span class="co">#&gt; 4 0.083    NA   NA 0.083 1</span></span>
<span><span class="co">#&gt; 5    NA    NA 0.14 0.141 3</span></span>
<span><span class="co">#&gt; 6 0.035    NA   NA 0.035 1</span></span></code></pre></div>
<p>Column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>
is the failure time of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>-th
component, column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is the column for the series system lifetime, the same as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>k</mi></msub><annotation encoding="application/x-tex">t_k</annotation></semantics></math>,
and column
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the component that caused the system failure.</p>
<p>We see that the component cause of failure is observed and the other
component lifetimes are not observed (NA).</p>
<p>In what follows, we consider two cases of masking or censoring, or
otherwise <em>incomplete data</em> of some form.</p>
<ol style="list-style-type: decimal">
<li><p>We know the system lifetime and the component cause of failure.
(Columns
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
are observed.</p></li>
<li><p>We observe a system lifetime with a right-censoring mechanism and
the component cause of failure.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="case-1-observed-system-failure-time-and-component-cause-of-failure">Case 1: Observed system failure time and component cause of
failure<a class="anchor" aria-label="anchor" href="#case-1-observed-system-failure-time-and-component-cause-of-failure"></a>
</h2>
<p>Suppose we have a series system. As a series system, whenever a
component fails, the system fails, and thus the system lifetime is equal
to the minimum of the component lifetimes.</p>
<p>Suppose the component lifetimes are exponentially distributed with
rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\lambda_k</annotation></semantics></math>
for component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</p>
<p>In this case, we assume we can observe the system lifetime and the
component that caused the system failure, which means we know a few
things about each system in the sample:</p>
<ol style="list-style-type: decimal">
<li>The component cause of failure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
for each system
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</li>
<li>The system failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
for each system
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</li>
<li>The component failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><msub><mi>K</mi><mi>i</mi></msub></mrow></msub><annotation encoding="application/x-tex">T_{i K_i}</annotation></semantics></math>
for each system
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</li>
<li>Each of the non-failed component failure times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>p</mi></mrow></msub><annotation encoding="application/x-tex">T_{i p}</annotation></semantics></math>
for each system
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and each component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>≠</mo><msub><mi>K</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p \neq K_i</annotation></semantics></math>
survived at least until
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mspace width="0.167em"></mspace><msub><mi>K</mi><mi>i</mi></msub></mrow></msub><annotation encoding="application/x-tex">T_{i \, K_i}</annotation></semantics></math>.</li>
</ol>
<p>We might be tempted to think that we can just consider each
observation, where we know the system lifetime and the component cause,
and then just estimate the component’s parameter based on its failure
time. However, this is incorrect, because when we condition on the
component that caused the system failure, we are not observing a random
sample of that component’s lifetime, but a conditional sample. For
instance, if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>,
then we are observing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>&lt;</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>&lt;</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i 1} | T_{i 1} &lt; T_{i 2} \text{ and } T_{i 1} &lt; T_{i 3}</annotation></semantics></math>.</p>
<p>What is this distribution? We can derive it as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>,</mo><msub><mi>K</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>f</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>f</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    f_{T_i|K_i}(t_i | k_i) = f_{T_i,K_i}(t_i,k_i) / f_{K_i}(k_i) =
        f_{K_i|T_i}(k_i|t_i) f_{T_i}(t_i) / f_{K_i}(k_i).
</annotation></semantics></math> By the memoryless property of the
exponential distribution, we have
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    f_{K_i|T_i}(k_i|t_i) = f_{K_i}(k_i),
</annotation></semantics></math> since the failure rates are constant
(and thus independent of the time), and thus the probability that a
componet is the cause of a system failure is independent of the time of
the system failure.</p>
<p>That means that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    f_{T_i|K_i}(t_i | k_i) = f_{T_i}(t_i),
</annotation></semantics></math> which in the exponential case is just
the pdf of the series system. Since the minimum of exponentially
distributed random variables is exponentially distributed with a falure
rate equal to the sum of the failure rates of the components, this
estimator is an estimator of the sum of the failure rates (or the
failure rate of the series system).</p>
<p>Instead, we just consider this to be a kind of right-censoring
problem, where we have
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m=3</annotation></semantics></math>
components, and thus when component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
is the component cause of failure at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>,
that means we observe an exact failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_{i 1} = t_i</annotation></semantics></math>
and right-censor the other two components at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>.
The loglikehood contribution for this observation is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>log</mo><msub><mi>f</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>λ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><msub><mi>R</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><msub><mi>R</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>λ</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    L_i = \log f_1(t_i|\lambda_1) + \log R_2(t_i|\lambda_2) + \log R_3(t_i|\lambda_3),
</annotation></semantics></math> which simplifies to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mo>=</mo><mo>log</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>3</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
    L_i = \log \lambda_1 - (\lambda_1 + \lambda_2 + \lambda_3) t_i,
</annotation></semantics></math> which has a score
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><msub><mi>λ</mi><mn>1</mn></msub></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">
    s_i =
        \frac{1}{\lambda_1}
        \begin{bmatrix}
            1 \\
            0 \\
            0
        \end{bmatrix}
        - t_i
        \begin{bmatrix}
            1 \\
            1 \\
            1
        \end{bmatrix}
</annotation></semantics></math> and a Hessian
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><msubsup><mi>λ</mi><mn>1</mn><mn>2</mn></msubsup></mfrac><mrow><mo stretchy="true" form="prefix">[</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    H_i =
        -\frac{1}{\lambda_1^2}
        \begin{bmatrix}
            1 &amp; 0 &amp; 0 \\
            0 &amp; 0 &amp; 0 \\
            0 &amp; 0 &amp; 0
        \end{bmatrix}.
</annotation></semantics></math></p>
<p>To get the total log-likelihood, score, and Hessian, we just sum them
up (by i.i.d.).</p>
<p>In fact, that’s what we do here. We show how to use the likelihood
contribution model. We show two ways to configure the model to dispatch
the <code>loglik</code> and <code>score</code> functions for the
observation type.</p>
<p>We implement methods for the <code>loglik</code> and
<code>score</code> functions. This allows dispatching based on the
observation type, as defined in <code>obs_type</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">score.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">n</span> <span class="op">/</span> <span class="va">rates</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loglik.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">rates</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model.observed</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span> <span class="st">"observed"</span> <span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now that we have the likelihood model, we can use it to estimate the
parameters. We use the <code>optim</code> function to do the numerical
optimization. We use the <code>hessian = TRUE</code> argument to get the
Hessian matrix, which we can use to get the standard errors of the
estimates.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">rates</span>, fn <span class="op">=</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model.observed</span><span class="op">)</span>, df<span class="op">=</span><span class="va">df</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $par</span></span>
<span><span class="co">#&gt; [1] 1.4 1.3 1.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] -112</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $counts</span></span>
<span><span class="co">#&gt; function gradient </span></span>
<span><span class="co">#&gt;       66       NA </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $message</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>The estimates are close to the true rates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.1</mn><mo>,</mo><mn>1.2</mn><mo>,</mo><mn>1.3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda = (1.1, 1.2, 1.3)</annotation></semantics></math>,
and convergence code 0 indicates successful optimization.</p>
<p>Note that <code>likelihood_model</code> objects have a default method
for fitting MLEs, <code>fit</code>. Internally, this method uses
<code>optim</code> to maximize the log-likelihood, but it packs in some
additional information and returns the result as a
<code>fisher_mle</code> object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rates.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model.observed</span><span class="op">)</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="va">rates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">rates.hat</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimate (Fisherian)</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate Std. Error   2.5% 97.5%</span></span>
<span><span class="co">#&gt; [1,]   1.3669     0.1878 0.9989 1.735</span></span>
<span><span class="co">#&gt; [2,]   1.2639     0.1806 0.9100 1.618</span></span>
<span><span class="co">#&gt; [3,]   1.2383     0.1787 0.8880 1.589</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log-likelihood: -111.7 </span></span>
<span><span class="co">#&gt; AIC: 229.4 </span></span>
<span><span class="co">#&gt; Number of observations: 150</span></span></code></pre></div>
<p>The 95% confidence intervals all contain the true parameter values,
and the standard errors are small relative to the estimates, reflecting
the information in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">n=150</annotation></semantics></math>
observations.</p>
<p>We implement <code>hess_loglik.observed</code> for completeness.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hess_loglik.observed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span></span>
<span>  <span class="va">H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="va">counts</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">H</span><span class="op">[</span><span class="va">j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">counts</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">/</span> <span class="va">rates</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">H</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Observed information from MLE (negative Hessian)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observed information matrix (from MLE):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observed information matrix (from MLE):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">-</span><span class="va">rates.hat</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]     [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,]  2.8e+01 -9.9e-11 -1.5e-09</span></span>
<span><span class="co">#&gt; [2,] -9.9e-11  3.1e+01  1.0e-09</span></span>
<span><span class="co">#&gt; [3,] -1.5e-09  1.0e-09  3.1e+01</span></span>
<span></span>
<span><span class="co"># Computed directly via hess_loglik</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nHessian at MLE:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Hessian at MLE:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/hess_loglik.html">hess_loglik</a></span><span class="op">(</span><span class="va">model.observed</span><span class="op">)</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">rates.hat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]  -28    0    0</span></span>
<span><span class="co">#&gt; [2,]    0  -31    0</span></span>
<span><span class="co">#&gt; [3,]    0    0  -31</span></span></code></pre></div>
<p>The two matrices agree, confirming that our analytical
<code>hess_loglik.observed</code> implementation is correct.</p>
<p>Now, we use the Bootstrap method to estimate the sampling
distribution of the MLE.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/algebraic.mle-reexports.html">sampler</a></span><span class="op">(</span><span class="va">model.observed</span>, df <span class="op">=</span> <span class="va">df</span>, par <span class="op">=</span> <span class="va">rates</span><span class="op">)</span></span>
<span><span class="va">boot_result</span> <span class="op">&lt;-</span> <span class="fu">model.samp</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Bootstrap MLE:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Bootstrap MLE:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.4 1.3 1.2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBootstrap standard errors:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap standard errors:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/algebraic.mle-reexports.html">se</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.19 0.18 0.17</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBootstrap bias:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap bias:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/algebraic.mle-reexports.html">bias</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0045 0.0057 0.0039</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBootstrap covariance:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Bootstrap covariance:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">boot_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         [,1]    [,2]    [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.0364  0.0003 -0.0025</span></span>
<span><span class="co">#&gt; [2,]  0.0003  0.0326 -0.0031</span></span>
<span><span class="co">#&gt; [3,] -0.0025 -0.0031  0.0292</span></span></code></pre></div>
<p>The bootstrap standard errors should be close to the asymptotic
standard errors from the Fisher information matrix, and the bootstrap
bias estimates should be negligible (all under 0.01), confirming that
the MLE is nearly unbiased for this sample size.</p>
</div>
<div class="section level2">
<h2 id="case-2-right-censoring">Case 2: Right-censoring<a class="anchor" aria-label="anchor" href="#case-2-right-censoring"></a>
</h2>
<p>We add right-censoring to the model. We assume that the
right-censoring times are independent of the component lifetimes and the
candidate sets.</p>
<p>In particular, we consider the data described earlier, but with
right-censoring at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau = 0.5</annotation></semantics></math>.
The presence of this right-censoring means that we know the event
occurred after time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
for these censored observations, but we do not know exactly when (and it
may still be ongoing).</p>
<p>As a first stab, you might be inclined to just ignore the censored
data. However, this is not a good idea, because it will lead to biased
estimates. This is problematic because then we are estimating the
parameters of a truncated distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub><mo>&lt;</mo><mi>τ</mi></mrow><annotation encoding="application/x-tex">T_i | T_i &lt; \tau</annotation></semantics></math>,
rather than the original distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>,</mo><msub><mi>τ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i, \tau_i</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i = T_i</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>τ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i &lt; \tau_i</annotation></semantics></math>
and otherwise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub><mo>=</mo><msub><mi>τ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i = \tau_i</annotation></semantics></math>.
This is a well-known problem in statistics, and it is why we need to use
<em>survival analysis</em> techniques to handle right-censored data.</p>
<p>This is similiar to the earlier problem we described where we said it
was a mistake to only focus on the component cause of failure and
estimate the parameters of the components independently. In that case,
we would be estimating component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>’s
parameters from the truncated distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">T_{i j} | K_i = j</annotation></semantics></math>,
rather than the original distribution,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">T_i = \min\{T_{i 1}, \ldots, T_{i m}\}</annotation></semantics></math>.
In either case, the censoring or masking mechanisms must not be ignored,
otherwise we will get biased estimates.</p>
<p>Here’s what that right-censored data looks like, with right-censoring
time of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\tau = 0.5</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># if df$t &gt; .5, then the system was right-censored</span></span>
<span><span class="va">df.censored</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">|&gt;</span> <span class="fu">mutate</span><span class="op">(</span></span>
<span>    censored <span class="op">=</span> <span class="va">t</span> <span class="op">&gt;</span> <span class="fl">.5</span>,</span>
<span>    t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">censored</span>, <span class="fl">.5</span>, <span class="va">t</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df.censored</span><span class="op">[</span><span class="va">df.censored</span><span class="op">[</span>, <span class="st">"censored"</span><span class="op">]</span>, <span class="st">"k"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">df.censored</span><span class="op">[</span><span class="va">df.censored</span><span class="op">[</span>, <span class="st">"censored"</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df.censored</span><span class="op">)</span></span>
<span><span class="co">#&gt;      t1    t2   t3     t k censored</span></span>
<span><span class="co">#&gt; 1    NA 0.320   NA 0.320 2    FALSE</span></span>
<span><span class="co">#&gt; 2    NA 0.045   NA 0.045 2    FALSE</span></span>
<span><span class="co">#&gt; 3    NA 0.049   NA 0.049 2    FALSE</span></span>
<span><span class="co">#&gt; 4 0.083    NA   NA 0.083 1    FALSE</span></span>
<span><span class="co">#&gt; 5    NA    NA 0.14 0.141 3    FALSE</span></span>
<span><span class="co">#&gt; 6 0.035    NA   NA 0.035 1    FALSE</span></span></code></pre></div>
<p>We construct their censoring functions with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loglik.censored</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">score.censored</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">hess_loglik_censored</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">rates</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">p</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">model.censored</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>    obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">censored</span>, <span class="st">"censored"</span>, <span class="st">"observed"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mle.censored</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model.censored</span><span class="op">)</span><span class="op">(</span><span class="va">df.censored</span>, par <span class="op">=</span> <span class="va">rates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimate (Fisherian)</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;      Estimate Std. Error   2.5% 97.5%</span></span>
<span><span class="co">#&gt; [1,]   1.3242     0.1996 0.9329 1.715</span></span>
<span><span class="co">#&gt; [2,]   1.2639     0.1950 0.8816 1.646</span></span>
<span><span class="co">#&gt; [3,]   1.2037     0.1903 0.8306 1.577</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log-likelihood: -96.38 </span></span>
<span><span class="co">#&gt; AIC: 198.8 </span></span>
<span><span class="co">#&gt; Number of observations: 150</span></span></code></pre></div>
<p>So, recall the true parameters are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.1</mn><mo>,</mo><mn>1.2</mn><mo>,</mo><mn>1.3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>′</mi></mrow><annotation encoding="application/x-tex">\lambda = (1.1, 1.2, 1.3)'</annotation></semantics></math>.
We can see that the estimates are reasonable, particularly for the
relatively small sample size.</p>
<div class="section level3">
<h3 id="inference-on-censored-estimates">Inference on censored estimates<a class="anchor" aria-label="anchor" href="#inference-on-censored-estimates"></a>
</h3>
<p>Let’s examine the censored estimates more closely and compare them to
the uncensored case. Censoring reduces information, so we expect wider
confidence intervals:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Uncensored estimates:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Uncensored estimates:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Estimates:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">rates.hat</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Estimates: 1.4 1.3 1.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Std errors:"</span>, <span class="fu"><a href="../reference/algebraic.mle-reexports.html">se</a></span><span class="op">(</span><span class="va">rates.hat</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Std errors: 0.19 0.18 0.18</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nCensored estimates:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Censored estimates:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Estimates:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Estimates: 1.3 1.3 1.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Std errors:"</span>, <span class="fu"><a href="../reference/algebraic.mle-reexports.html">se</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Std errors: 0.2 0.2 0.19</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n95% Confidence Intervals (uncensored):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% Confidence Intervals (uncensored):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">rates.hat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      2.5% 97.5%</span></span>
<span><span class="co">#&gt; [1,] 1.00   1.7</span></span>
<span><span class="co">#&gt; [2,] 0.91   1.6</span></span>
<span><span class="co">#&gt; [3,] 0.89   1.6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n95% Confidence Intervals (censored):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 95% Confidence Intervals (censored):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      2.5% 97.5%</span></span>
<span><span class="co">#&gt; [1,] 0.93   1.7</span></span>
<span><span class="co">#&gt; [2,] 0.88   1.6</span></span>
<span><span class="co">#&gt; [3,] 0.83   1.6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTrue parameters:"</span>, <span class="va">rates</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; True parameters: 1.1 1.2 1.3</span></span></code></pre></div>
<p>As expected, censoring inflates the standard errors and widens the
confidence intervals because the censored observations carry less
information than exact ones. Both sets of intervals still contain the
true parameter values.</p>
<p>We can also use Fisherian likelihood inference to examine the
strength of evidence for the censored estimates:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Support at MLE (should be 0)</span></span>
<span><span class="va">s_at_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/support.html">support</a></span><span class="op">(</span><span class="va">mle.censored</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span>, <span class="va">df.censored</span>,</span>
<span>                    <span class="va">model.censored</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Support at MLE:"</span>, <span class="va">s_at_mle</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Support at MLE: 0</span></span>
<span></span>
<span><span class="co"># Evidence for MLE vs true parameters</span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evidence.html">evidence</a></span><span class="op">(</span><span class="va">model.censored</span>, <span class="va">df.censored</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mle.censored</span><span class="op">)</span>, <span class="va">rates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Evidence (MLE vs true):"</span>, <span class="va">ev</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Evidence (MLE vs true): 0.89</span></span>
<span></span>
<span><span class="co"># Likelihood interval for rate 1 (first component)</span></span>
<span><span class="va">li</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/likelihood_interval.html">likelihood_interval</a></span><span class="op">(</span><span class="va">mle.censored</span>, <span class="va">df.censored</span>, <span class="va">model.censored</span>,</span>
<span>                          k <span class="op">=</span> <span class="fl">8</span>, param <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n1/8 likelihood interval for lambda_1:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1/8 likelihood interval for lambda_1:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">li</span><span class="op">)</span></span>
<span><span class="co">#&gt; 1/8 Likelihood Interval (R &gt;= 0.125)</span></span>
<span><span class="co">#&gt; -----------------------------------</span></span>
<span><span class="co">#&gt;      lower upper</span></span>
<span><span class="co">#&gt; [1,]  0.96   1.8</span></span>
<span><span class="co">#&gt; attr(,"k")</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; attr(,"relative_likelihood_cutoff")</span></span>
<span><span class="co">#&gt; [1] 0.12</span></span></code></pre></div>
<p>The evidence value near 0 means the MLE and true parameters are about
equally well-supported by the data, which is expected when the MLE is
close to the truth. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">1/8</annotation></semantics></math>
likelihood interval for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math>
provides a plausible range for the parameter without making probability
statements — it contains all parameter values whose likelihood is at
least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>8</mn></mrow><annotation encoding="application/x-tex">1/8</annotation></semantics></math>
of the maximum.</p>
</div>
</div>
<div class="section level2">
<h2 id="case-3-single-parameter-model-exponential-rate">Case 3: Single-parameter model (exponential rate)<a class="anchor" aria-label="anchor" href="#case-3-single-parameter-model-exponential-rate"></a>
</h2>
<p>The <code>likelihood_contr_model</code> also works well with
single-parameter models. Here we estimate a single exponential rate from
data where some observations are exact and others are right-censored,
using separate contribution types for each.</p>
<p>This example also demonstrates that the <code>score</code> function
works correctly with scalar parameters (a case that requires careful
handling of R’s dimension-dropping behavior).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define contribution types for a single-rate exponential</span></span>
<span><span class="va">loglik.exp_exact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span> <span class="op">-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">loglik.exp_right</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">-</span><span class="va">lambda</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">score.exp_exact</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">score.exp_right</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Simulate right-censored exponential data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">lambda_true</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span>
<span><span class="va">n_single</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">censor_time_single</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span>
<span></span>
<span><span class="va">raw_lifetimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n_single</span>, <span class="va">lambda_true</span><span class="op">)</span></span>
<span><span class="va">df_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">raw_lifetimes</span>, <span class="va">censor_time_single</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">raw_lifetimes</span> <span class="op">&gt;</span> <span class="va">censor_time_single</span>, <span class="st">"exp_right"</span>, <span class="st">"exp_exact"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exact observations:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df_single</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"exp_exact"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exact observations: 106</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Right-censored:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df_single</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"exp_right"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Right-censored: 94</span></span>
<span></span>
<span><span class="va">model_single</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/likelihood_contr_model.html">likelihood_contr_model</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  obs_type <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="va">df</span><span class="op">$</span><span class="va">type</span>,</span>
<span>  assumptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exponential lifetimes"</span>, <span class="st">"non-informative right censoring"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit and verify</span></span>
<span><span class="va">mle_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model_single</span><span class="op">)</span><span class="op">(</span><span class="va">df_single</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mle_single</span><span class="op">)</span>, <span class="st">"(true:"</span>, <span class="va">lambda_true</span>, <span class="st">")\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; MLE: 1.8 (true: 2 )</span></span>
<span></span>
<span><span class="co"># Closed-form MLE for comparison: d / T</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df_single</span><span class="op">$</span><span class="va">type</span> <span class="op">==</span> <span class="st">"exp_exact"</span><span class="op">)</span></span>
<span><span class="va">total_T</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df_single</span><span class="op">$</span><span class="va">t</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Closed-form MLE:"</span>, <span class="va">d</span> <span class="op">/</span> <span class="va">total_T</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Closed-form MLE: 1.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"95% CI:"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">mle_single</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 95% CI: 1.5 2.2</span></span></code></pre></div>
<p>The <code>optim</code>-based MLE matches the closed-form estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mo>=</mo><mi>d</mi><mi>/</mi><mi>T</mi></mrow><annotation encoding="application/x-tex">\hat\lambda = d/T</annotation></semantics></math>
(number of exact observations divided by total observation time), and
the 95% confidence interval contains the true value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\lambda = 2</annotation></semantics></math>.</p>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="when-to-use-which-model-type">When to use which model type<a class="anchor" aria-label="anchor" href="#when-to-use-which-model-type"></a>
</h3>
<table class="table">
<colgroup>
<col width="32%">
<col width="67%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th>Recommended approach</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Standard distribution, possibly censored</td>
<td><code><a href="../reference/likelihood_name.html">likelihood_name()</a></code></td>
</tr>
<tr class="even">
<td>Heterogeneous observation types</td>
<td><code>likelihood_contr_model</code></td>
</tr>
<tr class="odd">
<td>Known analytical derivatives</td>
<td>Specialized model (e.g., <code>weibull_uncensored</code>)</td>
</tr>
<tr class="even">
<td>Closed-form MLE exists</td>
<td>Custom class with <code>fit</code> override (e.g.,
<code>exponential_lifetime</code>)</td>
</tr>
<tr class="odd">
<td>Standard distribution as a contribution</td>
<td>Define <code>loglik.&lt;type&gt;</code> using
<code>likelihood_name</code> internally</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="providing-analytical-derivatives">Providing analytical derivatives<a class="anchor" aria-label="anchor" href="#providing-analytical-derivatives"></a>
</h3>
<p>Numerical differentiation (the default fallback) works but is slow —
each gradient evaluation requires
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>r</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">2r \times p</annotation></semantics></math>
function evaluations (where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">r=6</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
is the number of parameters). When analytical derivatives are available,
providing <code>score.&lt;type&gt;</code> and
<code>hess_loglik.&lt;type&gt;</code> functions gives 10–100x
speedups:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Slow (default): numerical differentiation of loglik.my_type</span></span>
<span><span class="va">loglik.my_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span></span>
<span></span>
<span><span class="co"># Fast: provide analytical derivatives</span></span>
<span><span class="va">score.my_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span></span>
<span><span class="va">hess_loglik.my_type</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">par</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span></span></code></pre></div>
<p>The <code>likelihood_contr_model</code> checks for these functions in
order:</p>
<ol style="list-style-type: decimal">
<li>Functions passed directly via <code>logliks</code>,
<code>scores</code>, <code>hess_logliks</code> arguments</li>
<li>Functions found by name in the global environment
(<code>loglik.&lt;type&gt;</code>, etc.)</li>
<li>Numerical differentiation of the log-likelihood (last resort)</li>
</ol>
</div>
<div class="section level3">
<h3 id="performance-tip-the-s3-cache">Performance tip: the S3 cache<a class="anchor" aria-label="anchor" href="#performance-tip-the-s3-cache"></a>
</h3>
<p>The S3 wrappers (<code>loglik(model)</code>,
<code>score(model)</code>, <code>hess_loglik(model)</code>) cache the
data frame split and resolved dispatcher functions. During optimization,
<code>optim</code> calls the returned function hundreds of times with
the same <code>df</code> but varying <code>par</code> — caching
eliminates the repeated <code><a href="https://rdrr.io/r/base/split.html" class="external-link">split()</a></code> and <code>obs_type()</code>
overhead. Always use the S3 interface for optimization:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Good: cached S3 wrapper</span></span>
<span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loglik.html">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="va">par</span>, fn <span class="op">=</span> <span class="va">ll</span>, df <span class="op">=</span> <span class="va">df</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Also good: using fit() which does this internally</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="va">par</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Slower: calling R6 method directly in a loop (no caching)</span></span>
<span><span class="co"># model$loglik(df, par) -- re-splits df every call</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
