<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Exponential Lifetime Model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Exponential Lifetime Model</h1>


<div id="TOC">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#uncensored-data" id="toc-uncensored-data">Uncensored
Data</a>
<ul>
<li><a href="#closed-form-mle" id="toc-closed-form-mle">Closed-Form
MLE</a></li>
<li><a href="#how-the-closed-form-mle-works" id="toc-how-the-closed-form-mle-works">How the Closed-Form MLE
Works</a></li>
</ul></li>
<li><a href="#right-censored-data" id="toc-right-censored-data">Right-Censored Data</a>
<ul>
<li><a href="#fitting-with-censoring" id="toc-fitting-with-censoring">Fitting with Censoring</a></li>
<li><a href="#ignoring-censoring-leads-to-bias" id="toc-ignoring-censoring-leads-to-bias">Ignoring Censoring Leads to
Bias</a></li>
</ul></li>
<li><a href="#analytical-derivatives" id="toc-analytical-derivatives">Analytical Derivatives</a></li>
<li><a href="#fisher-information-matrix" id="toc-fisher-information-matrix">Fisher Information Matrix</a></li>
<li><a href="#fisherian-likelihood-inference" id="toc-fisherian-likelihood-inference">Fisherian Likelihood
Inference</a>
<ul>
<li><a href="#likelihood-intervals" id="toc-likelihood-intervals">Likelihood Intervals</a></li>
<li><a href="#profile-log-likelihood" id="toc-profile-log-likelihood">Profile Log-Likelihood</a></li>
</ul></li>
<li><a href="#monte-carlo-validation-with-rdata" id="toc-monte-carlo-validation-with-rdata">Monte Carlo Validation with
<code>rdata()</code></a></li>
<li><a href="#cross-validation-with-likelihood_nameexp" id="toc-cross-validation-with-likelihood_nameexp">Cross-Validation with
<code>likelihood_name(&quot;exp&quot;)</code></a></li>
<li><a href="#summary" id="toc-summary">Summary</a></li>
<li><a href="#session-info" id="toc-session-info">Session Info</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The <code>exponential_lifetime</code> model is a reference
implementation demonstrating how to build a specialized likelihood model
with:</p>
<ul>
<li><strong>Closed-form MLE</strong>: The <code>fit()</code> method
computes the MLE directly as <span class="math inline">\(\hat\lambda =
d/T\)</span>, bypassing <code>optim</code> entirely.</li>
<li><strong>Analytical derivatives</strong>: Score, Hessian, and Fisher
information matrix in closed form.</li>
<li><strong>Right-censoring</strong>: Natural handling via the
sufficient statistic <span class="math inline">\((d, T)\)</span>.</li>
<li><strong><code>rdata()</code> method</strong>: For Monte Carlo
validation and bootstrap studies.</li>
</ul>
<p>The log-likelihood for Exponential(<span class="math inline">\(\lambda\)</span>) data with right-censoring
is:</p>
<p><span class="math display">\[\ell(\lambda) = d \log \lambda - \lambda
T\]</span></p>
<p>where <span class="math inline">\(d\)</span> is the number of exact
(uncensored) observations and <span class="math inline">\(T\)</span> is
the total observation time (sum of all times, whether censored or
not).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(likelihood.model)</span></code></pre></div>
</div>
<div id="uncensored-data" class="section level2">
<h2>Uncensored Data</h2>
<p>The simplest case: all observations are exact.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">rexp</span>(<span class="dv">200</span>, <span class="at">rate =</span> true_lambda))</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="fu">assumptions</span>(model)</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;independent&quot;              &quot;identically distributed&quot; </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; [3] &quot;exponential distribution&quot;</span></span></code></pre></div>
<div id="closed-form-mle" class="section level3">
<h3>Closed-Form MLE</h3>
<p>Unlike most models that require <code>optim</code>, the exponential
model computes the MLE directly. No initial guess is needed:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>mle <span class="ot">&lt;-</span> <span class="fu">fit</span>(model)(df)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE:&quot;</span>, <span class="fu">coef</span>(mle), <span class="st">&quot;(true:&quot;</span>, true_lambda, <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; MLE: 2.159 (true: 2.5 )</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SE:&quot;</span>, <span class="fu">se</span>(mle), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; SE: 0.1527</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">confint</span>(mle)[<span class="dv">1</span>, ], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 95% CI: 1.86 2.458</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Score at MLE:&quot;</span>, <span class="fu">score_val</span>(mle), <span class="st">&quot;(exactly zero by construction)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Score at MLE: 0 (exactly zero by construction)</span></span></code></pre></div>
</div>
<div id="how-the-closed-form-mle-works" class="section level3">
<h3>How the Closed-Form MLE Works</h3>
<p>The MLE is <span class="math inline">\(\hat\lambda = n / \sum
x_i\)</span> for uncensored data. We can verify this against the manual
calculation:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>total_time <span class="ot">&lt;-</span> <span class="fu">sum</span>(df<span class="sc">$</span>t)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>manual_mle <span class="ot">&lt;-</span> n <span class="sc">/</span> total_time</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;fit() result:   &quot;</span>, <span class="fu">coef</span>(mle), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; fit() result:    2.159</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Manual n/T:     &quot;</span>, manual_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; Manual n/T:      2.159</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Match:&quot;</span>, <span class="fu">all.equal</span>(<span class="fu">unname</span>(<span class="fu">coef</span>(mle)), manual_mle), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Match: TRUE</span></span></code></pre></div>
</div>
</div>
<div id="right-censored-data" class="section level2">
<h2>Right-Censored Data</h2>
<p>In reliability and survival analysis, observations are often
right-censored: we know the item survived past a certain time, but not
when it actually failed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="fl">2.0</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>censor_time <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Generate latent failure times</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">300</span>, <span class="at">rate =</span> true_lambda)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>censored <span class="ot">&lt;-</span> x <span class="sc">&gt;</span> censor_time</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>df_cens <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">pmin</span>(x, censor_time),</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  <span class="at">status =</span> <span class="fu">ifelse</span>(censored, <span class="st">&quot;right&quot;</span>, <span class="st">&quot;exact&quot;</span>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Sample size:&quot;</span>, <span class="fu">nrow</span>(df_cens), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; Sample size: 300</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Censoring rate:&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(censored) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; Censoring rate: 41.7 %</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Exact observations (d):&quot;</span>, <span class="fu">sum</span>(<span class="sc">!</span>censored), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; Exact observations (d): 175</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Total time (T):&quot;</span>, <span class="fu">round</span>(<span class="fu">sum</span>(df_cens<span class="sc">$</span>t), <span class="dv">2</span>), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; Total time (T): 100.8</span></span></code></pre></div>
<div id="fitting-with-censoring" class="section level3">
<h3>Fitting with Censoring</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>model_cens <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>, <span class="at">censor_col =</span> <span class="st">&quot;status&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">assumptions</span>(model_cens)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;independent&quot;                     &quot;identically distributed&quot;        </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; [3] &quot;exponential distribution&quot;        &quot;non-informative right censoring&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>mle_cens <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_cens)(df_cens)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">MLE:&quot;</span>, <span class="fu">coef</span>(mle_cens), <span class="st">&quot;(true:&quot;</span>, true_lambda, <span class="st">&quot;)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; MLE: 1.737 (true: 2 )</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;SE:&quot;</span>, <span class="fu">se</span>(mle_cens), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; SE: 0.1313</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% CI:&quot;</span>, <span class="fu">confint</span>(mle_cens)[<span class="dv">1</span>, ], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; 95% CI: 1.48 1.994</span></span></code></pre></div>
</div>
<div id="ignoring-censoring-leads-to-bias" class="section level3">
<h3>Ignoring Censoring Leads to Bias</h3>
<p>A common mistake is to treat censored times as if they were exact
observations. This biases the rate estimate upward (equivalently, the
mean lifetime downward):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Wrong: treat all observations as exact</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>model_wrong <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>mle_wrong <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_wrong)(df_cens)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Comparison:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; Comparison:</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True lambda:          &quot;</span>, true_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;   True lambda:           2</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  MLE (correct):        &quot;</span>, <span class="fu">coef</span>(mle_cens), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">#&gt;   MLE (correct):         1.737</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  MLE (ignoring censor):&quot;</span>, <span class="fu">coef</span>(mle_wrong), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">#&gt;   MLE (ignoring censor): 2.978</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ignoring censoring overestimates the failure rate!</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">#&gt; Ignoring censoring overestimates the failure rate!</span></span></code></pre></div>
</div>
</div>
<div id="analytical-derivatives" class="section level2">
<h2>Analytical Derivatives</h2>
<p>The model provides score and Hessian in closed form, which we can
verify against numerical differentiation:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df_small <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">rexp</span>(<span class="dv">50</span>, <span class="at">rate =</span> <span class="dv">3</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>model_small <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>lambda_test <span class="ot">&lt;-</span> <span class="fl">2.5</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co"># Analytical score</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>score_fn <span class="ot">&lt;-</span> <span class="fu">score</span>(model_small)</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>analytical_score <span class="ot">&lt;-</span> <span class="fu">score_fn</span>(df_small, lambda_test)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co"># Numerical score (via numDeriv)</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>ll_fn <span class="ot">&lt;-</span> <span class="fu">loglik</span>(model_small)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>numerical_score <span class="ot">&lt;-</span> numDeriv<span class="sc">::</span><span class="fu">grad</span>(</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="cf">function</span>(p) <span class="fu">ll_fn</span>(df_small, p), lambda_test</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Score at lambda =&quot;</span>, lambda_test, <span class="st">&quot;:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; Score at lambda = 2.5 :</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Analytical:&quot;</span>, analytical_score, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;   Analytical: 1.889</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Numerical: &quot;</span>, numerical_score, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;   Numerical:  1.889</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Match:&quot;</span>, <span class="fu">all.equal</span>(<span class="fu">unname</span>(analytical_score), numerical_score), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a><span class="co">#&gt;   Match: TRUE</span></span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a></span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="co"># Analytical Hessian</span></span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>hess_fn <span class="ot">&lt;-</span> <span class="fu">hess_loglik</span>(model_small)</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a>analytical_hess <span class="ot">&lt;-</span> <span class="fu">hess_fn</span>(df_small, lambda_test)</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>numerical_hess <span class="ot">&lt;-</span> numDeriv<span class="sc">::</span><span class="fu">hessian</span>(</span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>  <span class="cf">function</span>(p) <span class="fu">ll_fn</span>(df_small, p), lambda_test</span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>)</span>
<span id="cb8-32"><a href="#cb8-32" tabindex="-1"></a></span>
<span id="cb8-33"><a href="#cb8-33" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Hessian at lambda =&quot;</span>, lambda_test, <span class="st">&quot;:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-34"><a href="#cb8-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-35"><a href="#cb8-35" tabindex="-1"></a><span class="co">#&gt; Hessian at lambda = 2.5 :</span></span>
<span id="cb8-36"><a href="#cb8-36" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Analytical:&quot;</span>, analytical_hess[<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-37"><a href="#cb8-37" tabindex="-1"></a><span class="co">#&gt;   Analytical: -8</span></span>
<span id="cb8-38"><a href="#cb8-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Numerical: &quot;</span>, numerical_hess[<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-39"><a href="#cb8-39" tabindex="-1"></a><span class="co">#&gt;   Numerical:  -8</span></span>
<span id="cb8-40"><a href="#cb8-40" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Match:&quot;</span>, <span class="fu">all.equal</span>(analytical_hess[<span class="dv">1</span>, <span class="dv">1</span>], numerical_hess[<span class="dv">1</span>, <span class="dv">1</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb8-41"><a href="#cb8-41" tabindex="-1"></a><span class="co">#&gt;   Match: TRUE</span></span></code></pre></div>
</div>
<div id="fisher-information-matrix" class="section level2">
<h2>Fisher Information Matrix</h2>
<p>The expected Fisher information for Exponential(<span class="math inline">\(\lambda\)</span>) is <span class="math inline">\(I(\lambda) = n / \lambda^2\)</span>. The model
provides this analytically:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fim_fn <span class="ot">&lt;-</span> <span class="fu">fim</span>(model_small)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df_small)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>lambda_hat <span class="ot">&lt;-</span> <span class="fu">coef</span>(<span class="fu">fit</span>(model_small)(df_small))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>fim_analytical <span class="ot">&lt;-</span> <span class="fu">fim_fn</span>(lambda_hat, n_obs)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;FIM at MLE (lambda =&quot;</span>, lambda_hat, <span class="st">&quot;):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; FIM at MLE (lambda = 2.761 ):</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Analytical n/lambda^2:&quot;</span>, n_obs <span class="sc">/</span> lambda_hat<span class="sc">^</span><span class="dv">2</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt;   Analytical n/lambda^2: 6.56</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  fim() result:         &quot;</span>, fim_analytical[<span class="dv">1</span>, <span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt;   fim() result:          6.56</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Match:&quot;</span>, <span class="fu">all.equal</span>(n_obs <span class="sc">/</span> <span class="fu">unname</span>(lambda_hat)<span class="sc">^</span><span class="dv">2</span>, fim_analytical[<span class="dv">1</span>, <span class="dv">1</span>]), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt;   Match: TRUE</span></span></code></pre></div>
</div>
<div id="fisherian-likelihood-inference" class="section level2">
<h2>Fisherian Likelihood Inference</h2>
<p>The package supports pure likelihood-based inference. Instead of
confidence intervals (which make probability statements about
parameters), likelihood intervals identify the set of parameter values
that are “well supported” by the data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>df_fish <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="at">rate =</span> <span class="fl">2.0</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>model_fish <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>mle_fish <span class="ot">&lt;-</span> <span class="fu">fit</span>(model_fish)(df_fish)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co"># Support function: S(lambda) = logL(lambda) - logL(lambda_hat)</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Support at MLE is always 0</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>s_mle <span class="ot">&lt;-</span> <span class="fu">support</span>(mle_fish, <span class="fu">coef</span>(mle_fish), df_fish, model_fish)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Support at MLE:&quot;</span>, s_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; Support at MLE: 0</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co"># At a different value, support is negative</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>s_alt <span class="ot">&lt;-</span> <span class="fu">support</span>(mle_fish, <span class="fu">c</span>(<span class="at">lambda =</span> <span class="fl">1.5</span>), df_fish, model_fish)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Support at lambda=1.5:&quot;</span>, s_alt, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; Support at lambda=1.5: -1.375</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co"># Relative likelihood: R(lambda) = L(lambda)/L(lambda_hat) = exp(S)</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>rl_alt <span class="ot">&lt;-</span> <span class="fu">relative_likelihood</span>(mle_fish, <span class="fu">c</span>(<span class="at">lambda =</span> <span class="fl">1.5</span>), df_fish, model_fish)</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Relative likelihood at lambda=1.5:&quot;</span>, rl_alt, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; Relative likelihood at lambda=1.5: 0.253</span></span></code></pre></div>
<div id="likelihood-intervals" class="section level3">
<h3>Likelihood Intervals</h3>
<p>A 1/k likelihood interval contains all <span class="math inline">\(\lambda\)</span> where <span class="math inline">\(R(\lambda) \geq 1/k\)</span>. The 1/8 interval is
roughly analogous to a 95% confidence interval:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>li <span class="ot">&lt;-</span> <span class="fu">likelihood_interval</span>(mle_fish, df_fish, model_fish, <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">print</span>(li)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 1/8 Likelihood Interval (R &gt;= 0.125)</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; -----------------------------------</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;        lower upper</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; lambda  1.44 2.167</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;k&quot;)</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; [1] 8</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;relative_likelihood_cutoff&quot;)</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; [1] 0.125</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Wald 95% CI for comparison:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; Wald 95% CI for comparison:</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">confint</span>(mle_fish))</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;        2.5% 97.5%</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; lambda 1.43 2.128</span></span></code></pre></div>
</div>
<div id="profile-log-likelihood" class="section level3">
<h3>Profile Log-Likelihood</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>prof <span class="ot">&lt;-</span> <span class="fu">profile_loglik</span>(mle_fish, df_fish, model_fish, <span class="at">param =</span> <span class="dv">1</span>, <span class="at">n_grid =</span> <span class="dv">100</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">plot</span>(prof<span class="sc">$</span>lambda, prof<span class="sc">$</span>support, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="fu">expression</span>(lambda), <span class="at">ylab =</span> <span class="st">&quot;Support&quot;</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Profile Support Function&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">8</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">coef</span>(mle_fish), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Support S(lambda)&quot;</span>, <span class="st">&quot;1/8 cutoff&quot;</span>, <span class="st">&quot;MLE&quot;</span>),</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="monte-carlo-validation-with-rdata" class="section level2">
<h2>Monte Carlo Validation with <code>rdata()</code></h2>
<p>The <code>rdata()</code> method generates synthetic data from the
model, enabling Monte Carlo studies. Here we verify that the MLE is
unbiased and that the asymptotic standard error matches the empirical
standard deviation:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="fl">3.0</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>model_mc <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>gen <span class="ot">&lt;-</span> <span class="fu">rdata</span>(model_mc)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="co"># Simulate n_sim datasets and fit each</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>mle_vals <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_sim, {</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  sim_df <span class="ot">&lt;-</span> <span class="fu">gen</span>(true_lambda, n_obs)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="fu">coef</span>(<span class="fu">fit</span>(model_mc)(sim_df))</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>})</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Monte Carlo results (&quot;</span>, n_sim, <span class="st">&quot;simulations, n=&quot;</span>, n_obs, <span class="st">&quot;):</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; Monte Carlo results ( 1000 simulations, n= 100 ):</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  True lambda:       &quot;</span>, true_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt;   True lambda:        3</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Mean of MLEs:      &quot;</span>, <span class="fu">mean</span>(mle_vals), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt;   Mean of MLEs:       3.038</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Bias:              &quot;</span>, <span class="fu">mean</span>(mle_vals) <span class="sc">-</span> true_lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt;   Bias:               0.03775</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Empirical SE:      &quot;</span>, <span class="fu">sd</span>(mle_vals), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt;   Empirical SE:       0.3182</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Theoretical SE:    &quot;</span>, true_lambda <span class="sc">/</span> <span class="fu">sqrt</span>(n_obs), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt;   Theoretical SE:     0.3</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  (SE = lambda/sqrt(n) from Fisher information)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt;   (SE = lambda/sqrt(n) from Fisher information)</span></span></code></pre></div>
</div>
<div id="cross-validation-with-likelihood_nameexp" class="section level2">
<h2>Cross-Validation with <code>likelihood_name(&quot;exp&quot;)</code></h2>
<p>The analytical model should produce the same log-likelihood as the
generic distribution-wrapping approach:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>df_cv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="at">rate =</span> <span class="fl">2.0</span>))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>model_analytical <span class="ot">&lt;-</span> <span class="fu">exponential_lifetime</span>(<span class="st">&quot;t&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>model_generic <span class="ot">&lt;-</span> <span class="fu">likelihood_name</span>(<span class="st">&quot;exp&quot;</span>, <span class="at">ob_col =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>                                  <span class="at">censor_col =</span> <span class="st">&quot;censor&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># Need a censor column for likelihood_name</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>df_cv_generic <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">t =</span> df_cv<span class="sc">$</span>t, <span class="at">censor =</span> <span class="fu">rep</span>(<span class="st">&quot;exact&quot;</span>, <span class="dv">100</span>))</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>lambda_test <span class="ot">&lt;-</span> <span class="fl">2.3</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>ll_analytical <span class="ot">&lt;-</span> <span class="fu">loglik</span>(model_analytical)(df_cv, lambda_test)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>ll_generic <span class="ot">&lt;-</span> <span class="fu">loglik</span>(model_generic)(df_cv_generic, lambda_test)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Log-likelihood at lambda =&quot;</span>, lambda_test, <span class="st">&quot;:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; Log-likelihood at lambda = 2.3 :</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Analytical model:&quot;</span>, ll_analytical, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;   Analytical model: -46</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Generic model:   &quot;</span>, ll_generic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;   Generic model:    -46</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;  Match:&quot;</span>, <span class="fu">all.equal</span>(ll_analytical, ll_generic), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;   Match: TRUE</span></span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The <code>exponential_lifetime</code> model demonstrates several
design patterns available in the <code>likelihood.model</code>
framework:</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>How it’s implemented</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Closed-form MLE</td>
<td>Override <code>fit()</code> to return <code>fisher_mle</code>
directly</td>
</tr>
<tr class="even">
<td>Analytical derivatives</td>
<td>Implement <code>score()</code>, <code>hess_loglik()</code>,
<code>fim()</code></td>
</tr>
<tr class="odd">
<td>Right-censoring</td>
<td>Sufficient statistics <span class="math inline">\((d, T)\)</span>
handle censoring naturally</td>
</tr>
<tr class="even">
<td>Data generation</td>
<td><code>rdata()</code> method for Monte Carlo validation</td>
</tr>
<tr class="odd">
<td>Fisherian inference</td>
<td>Works out of the box via <code>support()</code>,
<code>likelihood_interval()</code>, etc.</td>
</tr>
</tbody>
</table>
<p>These patterns apply to any distribution where you want tighter
integration than <code>likelihood_name()</code> provides. See
<code>weibull_uncensored</code> for another example with analytical
derivatives (but without a closed-form MLE).</p>
</div>
<div id="session-info" class="section level2">
<h2>Session Info</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co">#&gt; R version 4.3.3 (2024-02-29)</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Matrix products: default</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.12.0 </span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.12.0</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; locale:</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; time zone: America/Chicago</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; attached base packages:</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; other attached packages:</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; [1] algebraic.dist_0.1.0   algebraic.mle_0.9.0    likelihood.model_0.9.1</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt;  [1] vctrs_0.6.5         cli_3.6.5           knitr_1.50         </span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt;  [4] rlang_1.1.7         xfun_0.54           generics_0.1.4     </span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt;  [7] jsonlite_2.0.0      glue_1.8.0          htmltools_0.5.8.1  </span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; [10] sass_0.4.10         rmarkdown_2.30      evaluate_1.0.5     </span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt; [13] jquerylib_0.1.4     MASS_7.3-60.0.1     fastmap_1.2.0      </span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="co">#&gt; [16] yaml_2.3.11         mvtnorm_1.3-3       lifecycle_1.0.5    </span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="co">#&gt; [19] numDeriv_2016.8-1.1 compiler_4.3.3      codetools_0.2-19   </span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="co">#&gt; [22] digest_0.6.39       R6_2.6.1            pillar_1.11.1      </span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; [25] bslib_0.9.0         tools_4.3.3         boot_1.3-32        </span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt; [28] cachem_1.1.0</span></span></code></pre></div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
